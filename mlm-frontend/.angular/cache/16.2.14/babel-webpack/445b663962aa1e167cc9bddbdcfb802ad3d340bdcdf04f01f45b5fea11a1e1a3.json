{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction GiveHelpComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4);\n    i0.ɵɵtext(1, \" No transactions found. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction GiveHelpComponent_div_4_button_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function GiveHelpComponent_div_4_button_15_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const transaction_r3 = i0.ɵɵnextContext().$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.openModal(transaction_r3._id, transaction_r3.amount, transaction_r3.receiverInfo.username));\n    });\n    i0.ɵɵtext(1, \" Pay \");\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function (a2) {\n  return {\n    \"card\": true,\n    \"mb-3\": true,\n    \"bg-success\": a2\n  };\n};\nfunction GiveHelpComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"h5\", 7);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 8);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\", 8);\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\", 8);\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(15, GiveHelpComponent_div_4_button_15_Template, 2, 0, \"button\", 9);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const transaction_r3 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(11, _c0, ctx_r1.isPaid(transaction_r3.status)));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Level \", transaction_r3.level, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Amount: \", transaction_r3.amount, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Username: \", transaction_r3.receiverInfo.username, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Mobile Number: \", transaction_r3.receiverInfo.mobileNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Status: \", transaction_r3.status, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Date: \", i0.ɵɵpipeBind2(14, 8, transaction_r3.date, \"medium\"), \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", transaction_r3.status != \"pending\" && transaction_r3.status !== \"paid\");\n  }\n}\nfunction GiveHelpComponent_div_5_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"div\", 13)(2, \"div\", 14)(3, \"div\", 15)(4, \"h5\", 16);\n    i0.ɵɵtext(5, \"Pay Transaction\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function GiveHelpComponent_div_5_div_1_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r10.closeModal());\n    });\n    i0.ɵɵelementStart(7, \"span\", 18);\n    i0.ɵɵtext(8, \"\\u00D7\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"div\", 19)(10, \"h5\");\n    i0.ɵɵtext(11, \"Receiver Information\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"p\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\");\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"p\");\n    i0.ɵɵtext(17);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"p\");\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"p\");\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(22, \"p\");\n    i0.ɵɵtext(23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 20)(25, \"label\", 21);\n    i0.ɵɵtext(26, \"UTR Number\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(27, \"input\", 22);\n    i0.ɵɵlistener(\"ngModelChange\", function GiveHelpComponent_div_5_div_1_Template_input_ngModelChange_27_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.utrNumber = $event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(28, \"div\", 23)(29, \"button\", 24);\n    i0.ɵɵlistener(\"click\", function GiveHelpComponent_div_5_div_1_Template_button_click_29_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r13.closeModal());\n    });\n    i0.ɵɵtext(30, \"Close\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(31, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function GiveHelpComponent_div_5_div_1_Template_button_click_31_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r14 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r14.submitUtrNumber());\n    });\n    i0.ɵɵtext(32, \"Pay Now\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const transaction_r8 = i0.ɵɵnextContext().$implicit;\n    const ctx_r9 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(13);\n    i0.ɵɵtextInterpolate1(\"Username: \", transaction_r8.receiverInfo.username, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Email: \", transaction_r8.receiverInfo.email, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Mobile Number: \", transaction_r8.receiverInfo.mobileNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Bank Account Number: \", transaction_r8.receiverInfo.bankDetails.accountNumber, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"IFSC Code: \", transaction_r8.receiverInfo.bankDetails.ifscCode, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"UPI Number: \", transaction_r8.receiverInfo.upiNumber, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r9.utrNumber);\n  }\n}\nfunction GiveHelpComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, GiveHelpComponent_div_5_div_1_Template, 33, 7, \"div\", 11);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const transaction_r8 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.currentTransactionId === transaction_r8._id);\n  }\n}\nexport let GiveHelpComponent = /*#__PURE__*/(() => {\n  class GiveHelpComponent {\n    constructor(http) {\n      this.http = http;\n      this.transactions = [];\n      this.currentTransactionId = null;\n      this.utrNumber = '';\n    }\n    ngOnInit() {\n      this.fetchTransactions();\n    }\n    fetchTransactions() {\n      const payerId = localStorage.getItem('_id');\n      if (!payerId) {\n        console.error('PayerId not found in localStorage');\n        return;\n      }\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      });\n      this.http.get(`${environment.apiUrl}/payments/transactions/payer/${payerId}`, {\n        headers\n      }).subscribe(response => {\n        this.transactions = response;\n      }, error => {\n        console.error('Error fetching transactions:', error);\n      });\n    }\n    openModal(transactionId, amount, username) {\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${localStorage.getItem('token')}`\n      });\n      this.http.post(`${environment.apiUrl}/payments/transactions/wanttopay`, {\n        username: username,\n        amount: amount\n      }, {\n        headers\n      }).subscribe(response => {\n        if (response.status === 201) {\n          this.currentTransactionId = transactionId;\n        } else {\n          alert(response.message);\n        }\n      });\n    }\n    closeModal() {\n      this.currentTransactionId = null;\n    }\n    isPaid(status) {\n      return status === 'paid';\n    }\n    submitUtrNumber() {\n      if (this.currentTransactionId) {\n        const transactionId = this.currentTransactionId;\n        const token = localStorage.getItem('token');\n        const payload = {\n          utrNumber: this.utrNumber,\n          status: 'pending'\n        };\n        this.http.put(`${environment.apiUrl}/payments/transactions/${transactionId}`, payload, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        }).subscribe(response => {\n          console.log('Transaction updated successfully:', response);\n          this.fetchTransactions();\n        }, error => {\n          console.error('Error updating transaction:', error);\n        });\n      }\n    }\n    static #_ = this.ɵfac = function GiveHelpComponent_Factory(t) {\n      return new (t || GiveHelpComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: GiveHelpComponent,\n      selectors: [[\"app-give-help\"]],\n      decls: 6,\n      vars: 3,\n      consts: [[1, \"container\"], [\"class\", \"alert alert-info\", 4, \"ngIf\"], [\"class\", \"card mb-3\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\"], [1, \"alert\", \"alert-info\"], [1, \"card\", \"mb-3\", 3, \"ngClass\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [\"type\", \"button\", \"class\", \"btn btn-primary\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"class\", \"modal fade show\", \"id\", \"payModal\", \"tabindex\", \"-1\", \"role\", \"dialog\", \"aria-labelledby\", \"payModalLabel\", \"aria-hidden\", \"true\", \"style\", \"display: block; background: rgba(0, 0, 0, 0.5);\", 4, \"ngIf\"], [\"id\", \"payModal\", \"tabindex\", \"-1\", \"role\", \"dialog\", \"aria-labelledby\", \"payModalLabel\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\", \"show\", 2, \"display\", \"block\", \"background\", \"rgba(0, 0, 0, 0.5)\"], [\"role\", \"document\", 1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"payModalLabel\", 1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"close\", 3, \"click\"], [\"aria-hidden\", \"true\"], [1, \"modal-body\"], [1, \"form-group\"], [\"for\", \"utrNumber\"], [\"type\", \"text\", \"id\", \"utrNumber\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"]],\n      template: function GiveHelpComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n          i0.ɵɵtext(2, \"Give Help\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(3, GiveHelpComponent_div_3_Template, 2, 0, \"div\", 1);\n          i0.ɵɵtemplate(4, GiveHelpComponent_div_4_Template, 16, 13, \"div\", 2);\n          i0.ɵɵtemplate(5, GiveHelpComponent_div_5_Template, 2, 1, \"div\", 3);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.transactions.length === 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngForOf\", ctx.transactions);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngForOf\", ctx.transactions);\n        }\n      },\n      dependencies: [i2.NgClass, i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i2.DatePipe]\n    });\n  }\n  return GiveHelpComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}